<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <template id="recv_bucket_page" name="Receivables Bucket Page">
    <t t-call="web.layout">
      <t t-set="title">Receivables – <t t-esc="bucket_label"/></t>
      <t t-call-assets="web.assets_backend" t-js="false"/>
      <t t-call-assets="web.assets_backend" t-css="false"/>

      <!-- number formatter -->
      <t t-set="fmt" t-value="lambda n: ('{:,.3f}'.format(float(n or 0.0)))"/>

      <div class="o_mssql_recv">
        <div class="o_recv__topbar" style="margin-bottom:.5rem">
          <a href="/recv/dashboard" class="btn btn-light btn-sm">← Back to Dashboard</a>
          <span class="o_recv__stamp" style="margin-left:.5rem">
            <small>Last updated: <strong t-esc="updated_at"/></small>
          </span>
        </div>

        <h2 t-esc="'Invoices – %s' % bucket_label"/>
        <p class="text-muted" style="margin-top:-.25rem">Open invoices in this bucket across all customers.</p>

        <div style="margin:.5rem 0 1rem">
          <strong>Total:</strong>
          <span t-esc="fmt(total)"/>
        </div>

        <table class="o_recv__table table table-sm table-striped">
          <colgroup>
            <col style="width:16%"/>
            <col style="width:24%"/>
            <col style="width:10%"/>
            <col style="width:10%"/>
            <col style="width:auto"/>
            <col style="width:12%"/>
          </colgroup>
          <thead>
            <tr>
              <th>Customer Code</th>
              <th>Customer</th>
              <th>Invoice #</th>
              <th>Date</th>
              <th>Description</th>
              <th class="text-end">Amount</th>
            </tr>
          </thead>
          <tbody>
            <t t-if="not rows">
              <tr><td colspan="6" class="text-center text-muted">No open invoices in this bucket.</td></tr>
            </t>
            <t t-foreach="rows" t-as="r">
              <tr>
                <td t-esc="r.get('customer_code')"/>
                <td t-esc="r.get('customer_name')"/>
                <td class="o-recv-invnum" t-esc="r.get('IDINV')"/>
                <td t-esc="r.get('DATEINVC')"/>
                <td t-esc="r.get('DESCINVC')"/>
                <td class="num" t-esc="fmt(r.get('AMTINVCHC'))"/>
              </tr>
            </t>
          </tbody>
        </table>
      </div>
    </t>
  </template>
</odoo>
